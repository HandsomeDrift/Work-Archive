# 机器学习用于心肌肌钙蛋白浓度诊断心肌梗死

## 摘要

尽管指南建议使用==固定的心脏肌钙蛋白阈值==来诊断心肌梗死，但肌钙蛋白浓度会受到年龄、性别、合并症以及症状发作时间的影响。为了改善诊断，我们开发了机器学习模型，这些模型将就诊时或连续测试中的心脏肌钙蛋白浓度与临床特征相结合，并计算出==急性冠状动脉综合症诊断与评估协作（CoDE-ACS）==评分（0-100），该==评分对应个体发生心肌梗死的概率==。模型在来自10,038名患者的数据上进行了训练（其中48%为女性），其性能在来自七个队列的10,286名患者（其中35%为女性）的数据上进行了外部验证。CoDE-ACS对心肌梗死的区分度极高（曲线下面积为0.953；95%置信区间为0.947-0.958），在各亚组中的表现良好，相较于固定心脏肌钙蛋白阈值，CoDE-ACS==识别了更多的低心肌梗死概率患者==（61%对27%），其阴性预测值相似，并且识别出的高心肌梗死概率患者更少（10%对16%），具有更高的阳性预测值被识别为低心肌梗死概率的患者，在30天（0.1%对0.5%和1.8%）和1年（0.3%对2.8%和4.2%；P < 0.001）内发生心脏死亡的比例较中高概率患者低。CoDE-ACS作为一种临床决策支持系统，有潜力减少住院率，并对患者和医疗服务提供者带来重大益处。

## 概述

高灵敏度的心肌肌钙蛋白检测能够采用加速诊断途径来评估有急性心肌梗死症状的患者1 - 10。这些途径现在被国家和国际临床实践指南推荐，但它们有一些重要的局限性。

首先，他们对所有患者使用固定的肌钙蛋白阈值，不考虑年龄、性别或已知影响心脏肌钙蛋白浓度的合共病[5,14 - 17]。其次，它们是基于特定的时间点进行连续检测的，这在繁忙的急诊科中很难始终如一地应用。第三，他们仅根据肌钙蛋白阈值将患者分为低、中、高风险心肌梗死，而不考虑其他重要信息，如症状发作时间或心电图结果19。最后，尽管这些途径在排除心肌梗死方面表现良好，但识别出患有心肌梗死的患者更具挑战性，而且第99百分位诊断阈值的表现在男性和女性、老年患者和合并疾病患者中是不一致的20 - 24。在这项研究中，我们假设机器学习方法==将心肌肌钙蛋白作为一种连续测量和已知影响浓度的临床特征结合起来==，可能提供一种更个性化的方法来==评估心肌梗死的可能性==并改善其诊断。

在一项关于高敏肌钙蛋白在疑似急性冠状动脉综合征患者评估中的预设分析（High-STEACS试验）中，我们评估了指南推荐的固定肌钙蛋白阈值的诊断表现，并==开发了一种临床决策支持系统，称为急性冠状动脉综合征的诊断与评估协作（CoDE-ACS）==。该系统利用机器学习模型来==计算个体患者发生心肌梗死的概率==。我们使用外部验证评估了CoDE-ACS的诊断性能，并与指南推荐的路径进行了比较，以展示其在临床实践中的潜力。

## 结果

衍生队列共包括10,038名可能发生心肌梗死的患者（中位年龄70岁，48%为女性），这些患者在苏格兰的10个二级或三级护理医院之一就诊（表1和扩展数据图1）。依据《第四版心肌梗死通用定义》确定研究基准，由两位独立的临床医生审查所有临床信息，如果存在意见分歧则由第三位审查。诊断结果包括ST段抬高的急性心肌梗死（1型）、4b型或4c型心肌梗死。为了估计心肌梗死的概率，模型分别在没有心肌损伤的患者和确诊的心肌损伤患者中进行了训练。共6,239例患者在首次测量时无心肌损伤，3,799例患者确诊心肌损伤，其中包括3,094例1型心肌梗死，132例4b或4c型心肌梗死。

## 心肌钙蛋白阈值的诊断性能

在无心肌损伤的患者中，初次检测时小于5 ng/l的排除阈值的阴性预测值为99.6（95%置信区间（95% CI），99.3–99.8）（补充表1）。

在症状发作后3小时内就诊的患者中，阴性预测值较低（扩展数据图2）。在就诊时有心肌损伤的患者中，性别特异性99百分位上限参考值的阳性预测值为49.4（95% CI，48.2–50.7）。所有亚组中均存在显著的异质性，65岁以上患者、女性以及患有缺血性心脏病和肾功能受损的患者中阳性预测值较低（图1）。

## 模型的训练和内部验证

在诊断时有或没有心肌损伤的患者中，使用XGBoost模型表现最佳，无论是使用首次心肌钙蛋白测量值还是连续测量值（补充表2）。这些XGBoost模型被整合到一个名为CoDE-ACS的临床决策支持系统中，该系统计算一个得分（0-100），代表个体患者发生心肌梗死的概率（https://decision-support.shinyapps.io/code-acs/）。

CoDE-ACS模型将心肌钙蛋白作为一个连续变量，与年龄、性别、症状发作时间、胸痛的存在、已知的缺血性心脏病、高脂血症、心率、收缩压、Killip分级、心电图上显示的心肌缺血、肾功能和血红蛋白等因素相结合（扩展数据图3）。

在没有心肌损伤的患者中，CoDE-ACS得分低于3的患者符合我们预先设定的诊断性能标准，其阴性预测值为99.5（99.3–99.8），灵敏度为90.2（84.7–95.0）。在有心肌损伤的患者中，CoDE-ACS得分为61或更高的患者符合我们预先设定的诊断性能标准，其阳性预测值为80.1（78.5–81.6），特异性为83.4（82.1–84.7）。这些得分在识别心肌梗死低概率和高概率患者方面，在各个亚组中的表现一致（扩展数据图4）。

当在模型中结合了呈现时和首次连续心肌钙蛋白测量值时，识别出就诊时心肌梗死低概率和高概率患者的相同得分（小于3和大于或等于61），在无心肌损伤的患者中给出的阴性预测值为99.5（99.2–99.8），灵敏度为95.5（92.0–98.5）；在有心肌损伤的患者中，阳性预测值为82.5（81.1–83.9），特异性为80.1（78.4–81.6）（扩展数据图5）。这些得分在结合了连续测量的模型中，其诊断性能在各患者亚组中也表现一致。

## 外部验证

外部验证队列由10,286名可能发生心肌梗死的患者组成（中位年龄60岁，35%为女性），这些患者来自六个国家的七项前瞻性队列研究（表1）。在8,664名有心肌损伤和1,622名无心肌损伤的患者中，通过连续心肌钙蛋白测量后最终确诊的结果分别为1,032例和267例心肌梗死。CoDE-ACS模型的区分能力极佳，在初次检测时的曲线下面积为0.953（95% CI，0.947–0.958），在连续检测时为0.966（95% CI，0.961–0.970）。同样，仅使用初次检测的心肌钙蛋白测量值和连续测量值的校准度也很好，Brier得分分别为0.053和0.051（图2和扩展数据图6）。

## CoDE-ACS路径与心肌钙蛋白阈值的比较

在外部验证队列中的10,286名患者中，共有1,299名（13%）被最终诊断为心肌梗死。当在症状出现时间距检测超过3小时、且心电图未显示心肌缺血的患者中应用小于5 ng l<sup>−1</sup>的阈值时，排除率为27%（10,286例中的2,819例）。此时的阴性预测值和敏感性分别为99.7（95% CI，99.5–99.8）和98.3（95% CI，97.8–98.6）。当在初次检测时应用性别特异性99百分位诊断阈值时，确诊率为16%（10,286例中的1,622例），阳性预测值和特异性分别为63.6（95% CI，62.7–64.5）和93.4（95% CI，92.9–93.9）。其余的57%（10,286例中的5,845例）患者的心肌钙蛋白浓度处于中间范围，或因其早期就诊或心电图异常而需要连续检测。

CoDE-ACS评分低于3分的患者占外部验证队列的61%（10,286例中的6,265例），在初次检测时，这些患者的阴性预测值为99.6（95% CI，99.4–99.7），敏感性为97.9（95% CI，97.6–98.2）（图3和补充表3和4）。CoDE-ACS评分为61分或更高的患者占10%（10,286例中的1,052例），这些患者在初次检测时被识别为高概率患者，阳性预测值为75.5（95% CI，74.6–76.3），特异性为97.1（95% CI，96.8–97.4）（图3）。在验证队列的所有亚组中，低概率和高概率的评分均表现良好，尽管在年龄和性别方面观察到了一些异质性（图4和扩展数据图7）。

验证队列中有2,969名（29%）患者在初次检测时CoDE-ACS评分为3至60分，这些患者建议进行连续检测。纳入任何时间点的第一次连续心肌钙蛋白测量后，评分小于3分和61分或更高的CoDE-ACS进一步识别出1,172例（11%）低概率患者和490例（5%）高概率患者。总体而言，这导致72%（10,286例中的7,437例）患者被识别为低概率，阴性预测值为99.6（95% CI，99.4–99.7），敏感性为97.5（95% CI，97.2–97.8）；15%（10,286例中的1,542例）患者被识别为高概率，阳性预测值为71.3（95% CI，70.4–72.1），特异性为95.1（95% CI，94.6–95.5）（图3和补充表3）。在两次心肌钙蛋白检测后，1,342名（13%）患者的概率仍处于中间状态，但临床决策支持系统中提供了各自的CoDE-ACS评分及其相关的诊断指标，可用于选择患者进行进一步的住院评估或门诊随访。

在一系列事后分析中，CoDE-ACS路径在美国队列中也得到了验证，相比连续心肌钙蛋白测量与相对变化标准，该队列的心肌梗死患病率较低，并分别在女性和男性中进行了评估。在一个由1,571名患者组成的美国队列中，其中64例（4%）被诊断为心肌梗死，该路径在初次检测时识别出49%（1,571例中的773例）患者为低概率，阴性预测值为99.9（95% CI，99.5–100），敏感性为98.4（95% CI，97.7–98.9）；2%（1,571例中的39例）患者为高概率，阳性预测值为61.5（95% CI，59.1–63.9），但特异性类似，为99.0（95% CI，98.4–99.4），与外部验证队列相比（补充表5）。CoDE-ACS与使用相对增幅20%（当初始值高于99百分位）和50%（当初始值低于99百分位）连续心肌钙蛋白测量相比较。在外部验证队列中，CoDE-ACS评分为61或更高的患者识别出更多的高概率患者（15%（10,286例中的1,542例）比10%（10,286例中的995例）），阳性预测值更高（71.3（95% CI，70.4–72.1）比67.4（95% CI，66.5–68.3）），特异性相似（补充表6）。在外部验证队列的3,629名女性和6,657名男性中分别评估了CoDE-ACS路径（扩展数据图8）。低概率评分的性能和效果在女性和男性中相似，但高概率评分的阳性预测值在女性中较低，为67.5（95% CI，65.9–69.0），而男性中为78.5（95% CI，77.5–79.4）。尽管用于外部验证的研究中疾病的患病率有所不同，CoDE-ACS在不同的医疗环境中表现良好（扩展数据图9）。在外部验证队列中进行了一项敏感性分析，报告了CoDE-ACS路径对更广泛的诊断结果（如1型、4b型、4c型或2型心肌梗死）的表现（补充表7）。

## CoDE-ACS路径与其他路径的比较

在我们的外部验证队列中，5,634名患者在初次检测和1小时时进行了心肌钙蛋白测量，使得CoDE-ACS与0/1小时路径得以比较，其中774例（14%）最终被诊断为心肌梗死（补充表8）。与0/1小时路径相比，CoDE-ACS在初次检测时识别出更多的低概率患者（57%对27%），且具有相似的阴性预测值（99.7（95% CI，99.5–99.8）对99.9（95% CI，99.8–100））（扩展数据图10）。CoDE-ACS在初次检测时识别出的高概率患者比例与0/1小时路径相似（12%对13%），但其阳性预测值更高（67.8（95% CI，66.6–69.0）对62.3（95% CI，61.0–63.5））。当纳入0和1小时的连续测量时，CoDE-ACS路径识别出的中等概率患者少于0/1小时路径（14%对29%）。

在我们的外部验证队列中，有2,271名患者在初次检测和3小时时具备了必要的临床特征和心肌钙蛋白测量，使得CoDE-ACS与病史、心电图（ECG）、年龄、危险因素和心肌钙蛋白（HEART）路径得以比较，其中360例（16%）最终被诊断为心肌梗死（补充表9）。HEART路径在初次检测时不排除任何患者，而CoDE-ACS识别出51%（2,271例中的1,169例）为低概率，阴性预测值为99.6（95% CI，99.2–99.8）。在3小时时，CoDE-ACS识别出的低概率患者是HEART路径的四倍（66%对16%），且具有相似的阴性预测值（99.7（95% CI，99.3–99.8）对100（95% CI，99.8–100））。HEART路径中的高风险标准的阳性预测值显著低于CoDE-ACS路径中的高概率评分（19.0（95% CI，17.4–20.6）对69.7（95% CI，67.7–71.5））。

相比于使用固定心肌钙蛋白阈值或风险评分的路径，结合机器学习模型的路径更具灵活性，使得卫生系统可以应用不同的标准来定义心肌梗死的低概率和高概率。例如，采用较低CoDE-ACS评分为2的路径将比采用评分为3的路径在初次检测时识别出更少的低概率心肌梗死患者（50%对61%），但具有更高的阴性预测值（99.7（95% CI，99.6–99.8）对99.6（95% CI，99.4–99.7））和敏感性（98.8（95% CI，98.6–99.0）对97.9（95% CI，97.6–98.2））（补充表10）。

## 根据CoDE-ACS评分分层的结局

在1年内，外部验证队列中共有144例（1.4%）心脏原因导致的死亡和317例（3.1%）任何原因导致的死亡。与在初次检测时被CoDE-ACS识别为中等或高概率的患者相比，被识别为低概率心肌梗死的患者在30天时的心脏死亡率和全因死亡率较低（心脏死亡：0.1% vs. 0.5%和1.8%；全因死亡：0.1% vs. 0.9%和2.0%，分别）以及在1年时（心脏死亡：0.3% vs. 2.8%和4.2%；全因死亡：1.1% vs. 6.1%和6.7%，分别；log-rank检验P < 0.001）（图5）。

## 讨论

在疑似急性心肌梗死的患者中，我们开发并验证了CoDE-ACS临床决策支持系统，该系统利用机器学习和单次或连续的高敏感性心脏肌钙蛋白测量来评估急性心肌梗死的概率。

与使用心脏肌钙蛋白阈值和风险评分的指南推荐路径相比，CoDE-ACS在初次检测时识别出两倍数量的低概率心肌梗死患者，其阴性预测值相似，但识别出的高概率患者更少，阳性预测值有所提高。与推荐的心脏肌钙蛋白阈值不同，CoDE-ACS评分在不同的亚组中表现良好，包括男性和女性、老年人、肾功能不全者以及症状发作后早期就诊的患者。我们在心肌梗死患病率从4%到16%不等的多种医疗系统中验证了其性能，并提出了一种路径，能够通过一次肌钙蛋白检测识别多达三分之二的低概率心肌梗死患者，并提高对那些肌钙蛋白水平升高且确诊急性心肌梗死患者的识别。虽然我们的模型是为了评估住院期间心肌梗死的概率而训练的，但被识别为低概率心肌梗死的患者在出院后的死亡风险也较低，1年内心脏死亡的概率不到1/300。如果在临床实践中应用，CoDE-ACS临床决策支持系统可以减少患者在急诊科的等待时间，避免那些不太可能发生心肌梗死且心脏死亡风险低的患者不必要的住院治疗，同时提高对心肌梗死而非心肌损伤患者的识别和治疗，对患者和医疗提供者均有益。

我们的研究直接受益于先前大量研究，这些研究描述了心脏肌钙蛋白与冠心病之间的关系，从而改变了对可能心肌梗死患者的评估方式。这些研究，特别是利用能够在诊断阈值以下定量检测心脏肌钙蛋白的高敏感性检测方法以及结合风险评分的路径，在改善护理方面起到了重要作用。使用统计模型来指导临床决策是该领域的合理进展，且比仅使用固定的肌钙蛋白阈值或风险评分的先前方法具有几个重要的优势。首先，已知心脏肌钙蛋白受年龄、性别和肾功能的影响。我们从连续患者的非选择性队列中发现，在应用包含这些特征的模型时，诊断阈值在这些群体中的表现差异显著减少。其次，不同症状、共病和风险因素的患者在检测前患有非缺血性心肌损伤或心肌梗死的概率不同。

将这些特征整合到CoDE-ACS模型中，而不是像HEART路径那样孤立考虑，显著提高了相比在所有患者中使用相同的固定肌钙蛋白阈值时，心肌梗死的阳性预测值。

第三，目前的国家和国际指南建议对症状发作3小时内就诊的所有患者进行连续的心脏肌钙蛋白测量，因为在心肌缺血事件发生后需要时间使心脏肌钙蛋白升高到排除心肌梗死的推荐阈值以上。通过整合症状发作时间，CoDE-ACS能够使用单次检测来排除早期就诊的患者。最后，目前的路径建议在那些肌钙蛋白浓度中等的患者中按固定时间点进行连续测量，这在常规实践中可能难以实施，并且可能会不必要地延长住院时间。先前的研究显示，有五分之一到三分之一的患者没有按照路径推荐进行心脏肌钙蛋白检测。在29%未能通过单次心脏肌钙蛋白测量被识别为低或高概率的患者中，CoDE-ACS通过整合检测时间信息，允许在灵活的时间点进行第二次测量。采用在灵活时间点进行连续测量的CoDE-ACS路径，将需要进一步观察和检测的患者比例减少了一半，并将减少当前诊断路径中因连续测量时间点不符而固有的潜在危害。

CoDE-ACS临床决策支持系统受到早期开创性研究的启发，并在我们之前的工作基础上取得了实质性进展。Troponin-Only Manchester Acute Coronary Syndromes评分结合了初次检测时的心脏肌钙蛋白T浓度和其他临床观察，通过逻辑回归识别出三分之一的疑似急性冠状动脉综合征患者为主要不良心脏事件的低风险人群。而心肌缺血损伤指数（MI3）则使用梯度提升算法来计算心肌梗死的概率，但存在一些局限性。首先，尽管CoDE-ACS在71%的患者中使用一次心脏肌钙蛋白检测即可做出判断，MI3要求对所有患者进行两次检测以估算概率。在实际中，这将大大限制MI3的有效性，因为目前加速的诊断路径能够基于一次心脏肌钙蛋白检测做出决策，并已被证明是安全的且可避免不必要的住院。其次，MI3评分仅基于年龄、性别和心脏肌钙蛋白浓度计算。虽然使用少量变量简化了操作，但未包含其他重要的影响心脏肌钙蛋白的因素，在患有共病的患者中，其阳性预测值和特异性较低。

最后，MI3是在一个小规模的选定患者队列中开发的，而我们在未选择的连续患者中进行验证时发现，其校准效果较差，尤其是在中等概率患者中。CoDE-ACS克服了这些限制，通过一次心脏肌钙蛋白测量估算概率，包括影响心脏肌钙蛋白浓度和检测前概率的其他特征，并在一个大型未选择的患者人群中训练模型。

在临床决策支持系统中使用机器学习模型相较于使用固定的心脏肌钙蛋白阈值来生成心肌梗死概率及其相关诊断指标的优势在于，医疗系统可以更灵活地应用决策支持系统。例如，在一个更为保守的医疗环境中，可以使用较低的CoDE-ACS评分来识别非常低概率的心肌梗死患者，其阴性预测值为99.8，假阴性率为1/500，这可以通过一次检测指导50%的患者出院。或者，在急诊科容量有限的医疗环境中，可以应用较低的CoDE-ACS评分来识别高概率患者，从而减少需要在急诊科进行观察和连续检测的中等概率患者的比例。我们的临床决策支持系统为用户提供选择诊断参数的选项，因此可以根据当地临床优先级优化患者流向，从而定义低概率和高概率的CoDE-ACS评分（https://decision-support.shinyapps.io/code-acs/）。未来，可能将CoDE-ACS与其他利用12导联心电图的机器学习方法相结合，以进一步优化性能并减少需要观察的患者比例。同样，结合其他检查结果也有助于我们的模型学习区分1型和2型心肌梗死。

虽然CoDE-ACS可能使心脏肌钙蛋白检测结果的解释更具灵活性，因此有助于患者在实践中的正确分流，但我们仍然主张使用性别特异性99百分位数作为心肌梗死的诊断阈值。事实上，我们在推导和验证队列中判定所有心肌梗死病例时均采用了这一阈值。然而，我们认识到，将一个固定的阈值应用于参考范围人口以外的个体患者时可能存在局限性。尽管在CoDE-ACS模型中整合了性别因素，但高概率评分在女性中的阳性预测值仍低于男性。

这可能反映了女性和男性在心肌梗死概率上的真实生物学差异，或是在外部验证队列中招募患者时出现的无意选择偏差。

最终，心肌梗死是一种需要判断的临床诊断，需要结合症状和体征、肌钙蛋白检测结果以及心脏影像学的发现。我们预期在CoDE-ACS临床决策支持系统中使用机器学习模型将增强而非取代这种临床判断，从而尽量减少护理中的不平等现象。

有几点局限性值得考虑。首先，CoDE-ACS模型是使用来自单一制造商的高敏感性心脏肌钙蛋白I检测方法进行训练和验证的。由于不同制造商的心脏肌钙蛋白检测方法并未标准化，因此CoDE-ACS需要针对其他检测方法进行重新训练和验证。其次，确认偏差可能部分解释了CoDE-ACS模型的优异表现，因为它们整合了心肌梗死诊断中固有的特征。然而，这一偏差已尽量减少，因为真相标准在CoDE-ACS模型开发之前已定义，并不会因此降低CoDE-ACS在实际应用中的客观实用性。第三，在我们的推导和验证队列中，患者的特征存在重要差异，这可能反映了研究纳入和排除标准、疾病流行率和医疗系统因素的不同。尽管存在这些差异，CoDE-ACS在不同的医疗环境中表现良好。然而，征得患者同意的方式而非未选择患者的入组可能引入了选择偏差，这可能导致年轻男性患者的过度代表，并导致在验证队列中的某些亚组中CoDE-ACS表现不一致。尽管存在这种异质性，各亚组中的假阴性率在心肌梗死检测前概率较高的患者中仍低于1%。我们承认，在高危亚组中，如年龄超过65岁的患者或有既往缺血性心脏病或肾功能损害的患者中，进一步的前瞻性验证将是有益的。任何决策支持系统或路径都不应在不考虑检测前概率和临床判断的情况下使用。在我们的应用中，预测值是与每个患者的评分一同报告的，因此临床医生可以利用这些信息指导护理。第四，尽管我们的评估包括来自七个国家的参与者，但大多数参与者是白人，因此我们无法评估不同种族群体中诊断性能的一致性。最后，CoDE-ACS是在已完成入组的队列中进行验证的，且护理并未受到我们的临床决策支持系统的指导。因此，有必要进行前瞻性验证，并评估将CoDE-ACS整合到实践中后提供诊断概率和决策支持对管理的影响。

综上所述，我们开发了一种使用机器学习结合单次或连续高敏感性心脏肌钙蛋白检测来评估急性心肌梗死概率的临床决策支持系统。CoDE-ACS优于使用固定心脏肌钙蛋白阈值或风险评分的路径，并且在不同的医疗系统和患者亚组中表现一致。我们提出了一种护理路径，该路径通过单次心脏肌钙蛋白检测识别更多的低概率心肌梗死患者，并在识别心肌梗死患者方面比当前的标准护理更有效。如果在实践中得到采用，CoDE-ACS可以减少急诊科的停留时间，防止不必要的住院，并改善早期心肌梗死的治疗，对患者和医疗提供者均有益处。

## 方法

### 研究人群

用于建立CoDE-ACS模型的人群来自于High-STEACS试验。如前所述，High-STEACS是一项分阶段楔形集群随机对照试验，旨在评估在苏格兰的10家二级和三级医院中，对连续入院的疑似急性冠状动脉综合征患者实施高敏感性心肌肌钙蛋白I检测的效果。该试验的时间范围为2013年6月10日至2016年3月3日（参考文献25）。

符合以下标准的患者被纳入此预先指定的次要分析（补充说明1）: (1) 年龄≥18岁；(2) 因疑似急性冠状动脉综合征入院；(3) 使用ARCHITECTSTAT高敏感性心肌肌钙蛋白I检测（雅培实验室）进行心肌肌钙蛋白检测；(4) 有可用于诊断评估的心电图和生理数据。患有ST段抬高型心肌梗死的患者被排除在外，因为他们会直接进行冠状动脉血运重建，而不会在急诊室进行肌钙蛋白检测（扩展数据图1）。

### 确定基准真相和结果

该模型的训练==目的是识别在首次住院期间被判定诊断为1型、4b型或4c型心肌梗死的患者==。基准真相的确定依据第四版全球心肌梗死定义，由两位临床医生独立进行评估，如果存在分歧，则由第三位评审者提供共识【11, 25, 50】。所有诊断均在以下情况下被评估：入院时或连续检测中存在心肌损伤证据，即任何高敏感性心肌肌钙蛋白I浓度高于性别特异的第99百分位。

1型心肌梗死的定义为心肌坏死（即任何高敏感性心肌肌钙蛋白I浓度高于第99百分位，且在进行连续检测时浓度有升高和/或下降的情况），并伴有可能的心肌梗死症状或心电图上心肌缺血的迹象。对于因其他疾病引起的氧需求增加或供应减少（例如心动过速性心律失常、低血压或贫血）而出现心肌缺血症状或迹象，以及非动脉粥样硬化性血栓形成和心肌坏死的冠状动脉机制的患者，被定义为2型心肌梗死。

4b型和4c型心肌梗死的定义是，在冠状动脉造影中，心肌缺血和心肌坏死分别与支架血栓形成或再狭窄相关联。研究使用了地区和国家注册表对患者进行为期1年的跟踪。死亡原因的判定由在首次入院时不知晓肌钙蛋白浓度的研究人员进行。

### 指南推荐的心肌肌钙蛋白阈值的表现

我们评估了指南推荐的心肌肌钙蛋白阈值在排除（5 ng/l）和确认（女性第99百分位为16 ng/l，男性为34 ng/l）心肌梗死时的诊断表现及识别患者的比例【21】。这些阈值在总体人群中进行了评估，同时在以下预设的亚组中进行了分析：年龄、性别、从症状发作到测量肌钙蛋白的时间、肾功能受损、既往缺血性心脏病、糖尿病、脑血管疾病以及心电图上的缺血表现。

### 特征选择与处理

我们使用高灵敏度心脏肌钙蛋白I浓度作为连续测量指标。我们选择了12个与心脏肌钙蛋白浓度和心肌梗死的预检概率相关的客观临床变量，或者有助于区分心肌损伤与心肌梗死的变量，这些变量在我们的模型训练阶段被发现具有最高的相对重要性。这些变量包括：年龄、性别、从症状出现到心脏肌钙蛋白测量的小时数、胸痛、已知的缺血性心脏病、高脂血症、心率、收缩压、Killip分级、心电图上的心肌缺血证据、肾功能（使用慢性肾病流行病学合作研究公式计算的估算肾小管滤过率）和血红蛋白。为了最大化我们模型的临床实用性，我们首先开发了仅使用呈现时的心脏肌钙蛋白浓度的模型。随后，我们开发了包括在早期和灵活时间点测量的第二次心脏肌钙蛋白浓度的模型。

### 模型开发、选择与外部验证

我们首先使用四种统计方法——==逻辑回归、朴素贝叶斯、随机森林和极端梯度提升（XGBoost）==——开发并评估了模型。XGBoost 是一种监督学习技术，最初由 Chen 和 Guestrin 提出。简而言之，梯度提升通过采用集成技术来迭代地提高回归和分类问题的模型准确性。==该集成算法通过创建决策树作为学习者的序列模型实现==，后续模型试图纠正前一个模型的错误。在提升方法中，被前一个模型错误分类的个体会被赋予更高的权重，以增加他们在后续模型中被选中的机会。每个模型随后以逐步的方式进行拟合，以==最小化损失函数，如绝对误差或平方误差==（即预测值与真实值之间的差异）。XGBoost 是通过重新设计梯度提升来显著提高算法速度，推动计算资源有限的模型。XGBoost 模型的==输出是一个概率分数==，使用训练模型的终端节点权重的和进行反向逻辑变换得出。

梯度提升模型的数学公式可以描述为：

$$
\hat{y_i} = \sum_{k=1}^{K} f_k(x_i), f_k \in F,
$$
其中，f 是一个将每个变量向量$ x_i $($x_i = \{x_1, x_2, ..., x_n\}, i = 1, 2, N$)映射到结果 $y_i$的函数，K 是分类和回归树的数量（$k = 1, 2, N$），F 是包含所有分类和回归树的函数空间。

XGBoost 优化一个目标函数，该函数形式为：

$$
Obj = \sum_{i=1}^{N} l(y_i, \hat{y_i}) + \sum_{k=1}^{K} \Omega(f_k)
$$
其中，第一项是损失函数 $l$，它评估模型拟合数据的效果，通过测量预测值 $y_i$ 与结果 $y_i$ 之间的差异。第二项是正则化项，是 XGBoost 用来避免过拟合的方法，通过惩罚模型的复杂性来实现。此外，为了最大程度发挥 XGBoost 的优势，我们通过 10 折交叉验证使用网格搜索策略对算法的超参数进行了调优（参见补充表 11）。

鉴于用于确诊和排除心肌梗死的特征不同，我们为==在就诊时有心肌损伤和无心肌损伤的患者分别开发了模型==。在这里，心肌损伤被定义为首次测量时心脏肌钙蛋白I浓度超过性别特异性的第99百分位上限（女性为16 ng/l，男性为34 ng/l）。

此外，考虑到临床指南建议使用单次心脏肌钙蛋白测量来确认或排除心肌梗死，我们也分别使用首次心脏肌钙蛋白测量和随后在灵活时间点的第二次连续测量来训练这些模型，因此每种方法有四个不同的模型。在所有模型中，我们对导出队列进行了10次数据集的多重插补，以处理缺失数据，并进行了10次10折交叉验证，计算出一个分数（0–100），该分数对应于个体患者发生心肌梗死的概率。

然后，我们确定了在预先设定的性能标准下，将最高比例的患者分类为高或低概率的分数，这些标准用于在有心肌损伤的患者中确认心肌梗死（80%的阳性预测值和80%的特异性），以及在无心肌损伤的患者中排除心肌梗死（99.5%的阴性预测值和90%的灵敏度）。这些标准基于先前的分析和国际调查，了解医生对风险的可接受程度。需要强调的是，这些性能标准用于分别评估在有和无心肌损伤的患者中的分数。当这些分数应用于所有可能的心肌梗死患者时，实际应用中会期望并要求更高的灵敏度和特异性。

在没有心肌损伤的患者中，符合我们预先设定的性能标准、识别出最大比例低风险患者的最佳区分模型被选中，并整合到我们的 CoDE-ACS 临床决策支持系统中（https://decision-support.shinyapps.io/code-acs/）。

我们在 Advantageous Predictors of Acute Coronary Syndromes Evaluation（APACE）、Improved Assessment of Chest Pain Trial（IMPACT）、2-Hour Accelerated Diagnostic Protocol to Assess Patients with Chest Pain Symptoms Using Contemporary Troponins as the Only Biomarker（ADAPT）、Emergency Department Assessment of Chest Pain Score（EDACS）、Signal Peptide in Acute Coronary Events（SPACE）和 Use of Abbott High Sensitivity Troponin I Assay in Acute Coronary Syndromes（UTROPIA）等来自瑞士、西班牙、波兰、捷克共和国、澳大利亚、新西兰和美国的队列中进行了外部验证。所有分析均在 R v.4.1.2 中进行。

### **外部验证中合并的队列研究描述**

**APACE** **研究设计与人群**：APACE 是一项前瞻性的国际多中心研究，共涉及五个国家的12个中心，旨在推进心肌梗死的早期诊断（ClinicalTrials.gov 注册号 NCT00470587）。在8,267名因症状提示心肌梗死而前往急诊科的成年患者（≥18岁）中，有5,995名被纳入外部验证数据集。用于验证 CoDE-ACS 模型的样本包括入组时的心脏肌钙蛋白样本以及在1、2或3小时的连续测试样本（根据样本的可用性）。尽管入组与肾功能无关，我们排除了终末期肾衰竭且正在接受慢性透析的患者。该研究按照《赫尔辛基宣言》的原则进行，并获得了当地伦理委员会的批准。所有患者均签署了书面知情同意书。对于本次分析，排除了ST段抬高型心肌梗死患者、入组时缺失高灵敏度心脏肌钙蛋白I浓度的患者，以及最终裁定仍无法确定诊断但至少有一个心脏肌钙蛋白浓度升高的患者，这可能提示心肌梗死。

**裁定与随访**。心肌梗死的定义和心脏肌钙蛋白浓度的解读按照当前指南的推荐进行。简而言之，当在临床环境中有心肌损伤的证据，并且心脏肌钙蛋白浓度有临床显著的升高和/或下降，且与心肌缺血一致时，即可诊断为心肌梗死。心肌梗死的患者进一步被分类为类型1（原发性冠状动脉事件）和类型2（由于需求增加或供应减少导致的缺血，例如快速心律失常或高血压急症）。所有其他患者被分类为不稳定型心绞痛、非心脏性胸痛、心脏但非冠状动脉疾病（例如，快速心律失常或心肌心包炎）或心脏肌钙蛋白浓度正常的未知原因症状。

最终诊断的裁定由核心实验室（巴塞尔大学医院）集中进行，所有患者均使用 Abbott ARCHITECT 高灵敏度心脏肌钙蛋白 I 检测（Abbott Laboratories）。具体而言，两名不直接参与患者护理的独立心脏病专家审查了所有可用的医疗记录（包括患者病史、体格检查、实验室检查结果（包括心脏肌钙蛋白浓度）、放射学检查、心电图、超声心动图、心脏运动测试、冠状动脉造影中的病变严重性和形态以及出院总结），从急诊科就诊到90天随访期间。在诊断存在争议的情况下，病例会与第三名心脏病专家共同审查和裁定。使用性别特异性的高灵敏度心脏肌钙蛋白 I 检测的第99百分位上限（女性16 ng/l，男性34 ng/l）来定义心肌损伤。

使用心脏肌钙蛋白的绝对变化来确定临床显著的变化。根据心脏肌钙蛋白的生物变异研究以及之前胸痛队列研究的数据，临床显著的绝对变化被定义为在6小时内的升高或下降至少10 ng/l，或者在假设线性变化的情况下，在3小时内的绝对变化为6 ng/l。患者在出院后3个月和12个月通过电话或书面形式联系。随访期间的死亡信息还通过患者的医院记录、家庭医生的记录和国家死亡登记处获得。

**IMPACT研究设计与人群**：IMPACT 是一项针对急诊科潜在急性冠状动脉综合症的成年患者的干预试验（ACTRN12611000206921）。共招募了1,366名患者，时间跨度为2011年2月至2014年3月，其中1,086名患者被纳入验证数据集。用于验证 CoDE-ACS 模型的样本包括入组时的心脏肌钙蛋白样本和2小时后的样本。该研究获得了皇家布里斯班和女子医院人类研究与伦理委员会（HREC/10/QRBW/403）的批准。所有参与者均签署了书面知情同意书。招募工作在0800至1700之间进行，招募的患者年龄均≥18岁，并且有至少5分钟的症状提示急性冠状动脉综合症，并计划进行相关检测。研究人员识别出符合条件的患者。如果患者有明确的非急性冠状动脉综合症病因、拒绝或无法提供知情同意（例如语言障碍）、研究人员认为招募不合适（例如终末期疾病）、从其他医院转入、孕妇、在前30天内已被招募到研究中或出院后无法或不愿被联系，则将这些患者排除在外。

按照 IMPACT 协议进行风险分层。首次心脏肌钙蛋白和心电图检测在入院时进行。高风险患者根据2006年国家心脏基金会/澳大利亚和新西兰心脏学会的指南进行治疗。低风险和中等风险患者则使用加速调查策略评估，并在首次检测后2小时进行重复的心脏肌钙蛋白检测。常规住院应激测试仅推荐给中等风险患者。低风险患者在0小时和2小时的生物标志物正常后出院，并向其全科医生说明不需要额外的客观检测。心脏肌钙蛋白通过 Beckman Coulter 第二代 AccuTnI 检测（Beckman Coulter）进行测量，以指导临床实践，并使用 Abbott ARCHITECT 高灵敏度心脏肌钙蛋白 I 检测（Abbott Laboratories）在储存样本中进行分析。该临床检测具有灵敏度，其变异系数在第99百分位值为0.04 μg/l 时为14%，变异系数为0.06 μg/l 时为10%。>0.04 μg/l 的值被认为是升高的。血样在入院时和2小时后（低风险和中等风险患者）以及在0小时和6小时（高风险患者）进行采集。所有可用的心脏肌钙蛋白结果均用于临床决策。

==此处省略部分内容==

## **数据可用性**

《高灵敏度心脏肌钙蛋白在疑似急性冠状动脉综合症患者评估中的应用》试验利用了多个常规电子健康数据源，这些数据源经过链接、去标识化，并由 DataLoch（https://dataloch.org/）在安全数据环境中保存。只有经过必要治理培训的批准人员才能访问这些数据。有关这些数据及外部验证数据集的访问，包括来自瑞士、西班牙、波兰、捷克共和国、澳大利亚、新西兰和美国的 Advantageous Predictors of Acute Coronary Syndromes Evaluation、Improved Assessment of Chest Pain Trial、2-Hour Accelerated Diagnostic Protocol to Assess Patients with Chest Pain Symptoms Using Contemporary Troponins as the Only Biomarker、Emergency Department Assessment of Chest Pain Score、Signal Peptide in Acute Coronary Events 和 Use of Abbott High Sensitivity Troponin I Assay in Acute Coronary Syndromes 队列的数据，请联系对应的作者获取。

### **代码可用性**

用于评估急性冠状动脉综合症诊断和评估协作（CoDE-ACS）模型的 R 代码可以通过 GitHub 获得（https://github.com/DimitriosDoudesis/CoDE-ACS-NatureMedicine），我们还创建了一个 R-shiny 评估工具，允许其他研究人员使用单个患者级数据运行 CoDE-ACS 模型（https://decision-support.shinyapps.io/code-acs/）。用于推导 CoDE-ACS 模型的数据集利用了多个常规电子健康数据源，这些数据源经过链接、去标识化，并由 DataLoch（https://dataloch.org/）在安全数据环境中保存。希望获取源数据和模型以进行大规模 CoDE-ACS 评估的研究人员应联系对应的作者，以安排治理培训、批准和访问我们的安全数据环境。